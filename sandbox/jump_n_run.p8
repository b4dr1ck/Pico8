pico-8 cartridge // http://www.pico-8.com
version 33
__lua__

function _init()
	startx=96
	starty=-8
	x=startx
	y=starty
	xspeed=0
	yspeed=0
	maxspeed=1
	maxjump=4
	col=8		
	frame=64
	
	-- collison detection
	function cget(x,y,f)
		if fget(mget(x/8,y/8)) == f then
			return true
		end
		
		return false
	end
	
	-- bounding-box collision
	function bb(x,y,w,h,f)
		if cget(x,y,f) or
					cget(x,h,f) or
					cget(w,y,f) or
					cget(w,h,f)
		then
			return true
		end
		return false	 
	end
	
end

function _update60()
 -- move right
	if btn(➡️) then
		xspeed=maxspeed
	-- move left
	elseif btn(⬅️) then
		xspeed=-maxspeed
	end
	-- jump
	if btnp(❎) then
		if cget(x,y+8,1) or
		   cget(x+7,y+8,1)
	 then
			yspeed=-maxjump
			sfx(0)
		end
	end
	
	-- stop player 
	if not btn(➡️) and
				not btn(⬅️) 
	then
		xspeed=0
	end
	
	-- add speed to x
	x+=xspeed
	
 -- collision detection
 -- left
	if cget(x,y,1) or cget(x,y+7,1)
	then
			xspeed = 0
			x = ceil(x/8)*8
 -- right			
	elseif cget(x+7,y,1) or cget(x+7,y+7,1)
	then
			xspeed = 0
			x = flr(x/8)*8
	end
	
	-- gravity
	if yspeed < 5 then
		yspeed+=0.25
	end
	
	-- add speed to y
	y+=yspeed	
	
	-- collision detection
	-- up
	if cget(x,y,1) or cget(x+7,y,1)
	then
			yspeed = 0
			y = ceil(y/8)*8
	-- down
	elseif cget(x,y+8,1) or cget(x+7,y+8,1)
	then
			yspeed = 0
			y = flr(y/8)*8
	end	

	-- detect a trap
	if bb(x+1,y+2,x+7,y+6,2) then
		x=startx
		y=starty
		sfx(1)
	end
	
	-- animations
	if yspeed < 0 then
		frame=65
	else
		frame=64
	end
	
end

function _draw()
	cls()
	map(0,0)
	spr(frame,x,y)
	
	-- camera
	if x > 0 and y > 0 then
		camera(flr(x/128) * 128, flr(y/128) * 128)
	end	
end

__gfx__
0000000055555555d666d666d666d666555555550000000000000000000000000000000000000000011101101121012000000000000070000007000000000000
0000000055d5555555555555555555555555d55570070070000000000000000000000000000b3000002102202022202000000000000077000077000000000010
0070070055555dd555555d55d555555555d55555e00e00e000000000000000000000000000003000002200200020002000000000007799777799770001100000
00077000555555555555555555d5555555555555e00e00e0bb0000bb00000000000000000bb0bb00002010000020012000000000000799700799700000000010
00077000dd555555d5555555555555d5555d55dd80080080330003330b0b0b0000ddd0000300030b002020000020102000000000000377000077300000011000
007007005555d55d55d55dd555dd55555d5555558e08e08e0030b000b003030b0d6676d003300303002002000000202000670000003007000070030000111000
000000005555555555555555555555d555555555880880880030303030b0b3030d67776d0003303000000000000020200dd6600030b0300000030b0300000010
000000005555555511111111555555551111111188288288000333003333330301d666d100010010000000000000200001ddd00003b3000000003b3011000000
00010000555555555555555555d55555555555558888ee70d5d5d5d5000000000000000000000000000000000000000000000000000000000000000000000000
0000000155555ddd5555d5555555555555555ddd88e00000d06060d0000000000000000000000000000000000000000000000000000000000000000000000000
011000005d555dd555d555555555d5555d555dd52000000060707060000000000000000000000000000000000000000000000000000000000000000000000000
00000110555d5555555555555ddd555d555d55558888ee7070707070000000000000000000000000000000000000000000000000000000000000000000000000
01101110555555d5555d55dd55d5d555555555d588e0000070707070000000000000000000000000000000000000000000000000000000000000000000000000
0110000055dd55555d55555155d5555555dd55552000000060606060000000000000000000000000000000000000000000000000000000000000000000000000
000000105d555d55555555101155555511555d518888ee70d0d0d0d0000000000000000000000000000000000000000000000000000000000000000000000000
010000005555555511111100001111110011111088e00000d5d5d5d5000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
28888882288888820000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
86788768888888880000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
87188178211221120000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
86688668822882280000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
82288228888888880000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
88888888888888880000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
88888888888888880000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
28888882288888820000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__gff__
0001010101020000000000000000000000010101010204000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__map__
0101040412000000000000000000000e000000000000000000000000000f0001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0112000000000000000000001000000303000000000f000000000010100f0016000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
010b0000000d00000010000f0f00000101080000100f10000000100f0f0f0c01000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0100100000030700000000100000070101030000001010000000001010000201000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
111010000011030c000000000000020101010300000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0100000000110402150000000000000111010100050707060500000009000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
010000000f140a0b000000060000000101041200130202021200000002020001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
010000100f10000000000002000f0001010a0000000b0a0b00000f000a0b0001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
110000000f0000000000000a0000001101000000000000000f100f0000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
110000000000001000000900080000010100000f0f0000000f0f030000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
01050000020200000e00020202000001010000000f100000000f040200000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0103000000000000020000100000000101000000000000030000000000100001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1101050000100000000010100000000101030300000003120000000000100201000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1101030c00000000090000080006000101010100000000000000000000000013000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0111010307070707030303030303070101010105070707000f000500060d0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0101010103030303010111110101030101010103030303001000030303030303000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__sfx__
0001000014750157501575016750197501b7501e750207502175022750267502a7502d7002d7002d7002d7002c7002c7002b7002970025700217001f7001e7001e7001f7001f7001f7001f7001f7002170013200
000500000117001170011700117001170011700117001170011000110001100040000700007000080000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
