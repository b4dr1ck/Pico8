pico-8 cartridge // http://www.pico-8.com
version 16
__lua__
function _init()
	-- player variables
	p=	{	x= 64,
			y= -8,
			xspeed= 0,
			accel= 0.25,
			maxspeed= 2,
			jumpspeed= 3,
			yspeed= 0,
			friction= 0.25,
			direction= false,
			gravity= 0.25,
			on_ground=true,
			dead= false,
			frame= 33
}		
    
 -- collisions
 c= { left=   function(flag,x,y,offset) 
               if fget(mget(flr((x+offset)/8),flr((y+offset)/8))) == flag or
                  fget(mget(flr((x+offset)/8),flr((y+7-offset)/8))) == flag
               then
                return true
               else
                return false
               end
              end ,
      right=  function(flag,x,y,offset) 
               if fget(mget(flr((x+8-offset)/8),flr((y+offset)/8))) == flag or
                  fget(mget(flr((x+8-offset)/8),flr((y+7-offset)/8))) == flag
               then
                return true
               else
                return false
               end
              end,
      up=     function(flag,x,y,offset) 
               if fget(mget(flr((x+offset)/8),flr((y+offset)/8))) == flag or
                  fget(mget(flr((x+7-offset)/8),flr((y+offset)/8))) == flag
               then
                return true
               else
                return false
               end
              end,
      down=   function(flag,x,y,offset) 
               if fget(mget(flr((x+offset)/8),flr((y+8-offset)/8))) == flag or
                  fget(mget(flr((x+7-offset)/8),flr((y+8-offset)/8))) == flag
               then
                return true
               else
                return false
               end
              end
 }
 
	timer=0 -- time-events
	
	music(0)
end

-- custom functions
function animate(player,frame_start,frame_end,delay)
 if player.frame < frame_end and timer % delay == 0 then
  player.frame+=1
 else
  player.frame=frame_start
 end
end

function _update()
 -- if player is dead, return
	if p.dead then
		music(-1)
		if btnp(5) then
			p.dead=false
			_init()
		else
			return
		end
	end
	
	-- game timer handling 
	if timer < 100 then
		timer+=1
	else
		timer=0
	end		

 ------------------------------	
 -- add speed to players x
	p.x += p.xspeed

	-- collision detection
 -- left
	if c.left(1,p.x,p.y,0) then
			p.xspeed = 0
			p.x = ceil(p.x/8)*8
end
 -- right			
	if c.right(1,p.x,p.y,0) then
			p.xspeed = 0
			p.x = flr(p.x/8)*8
	end

 ------------------------------
 -- gravity
	p.yspeed+=p.gravity

	-- add speed to players y
	p.y += p.yspeed	

	-- collision detection
	-- up
	if c.up(1,p.x,p.y,0) then
			p.yspeed = 0
			p.y = ceil(p.y/8)*8
end
	-- down
	if c.down(1,p.x,p.y,0) then
			p.on_ground=true -- player stand on the ground
			p.yspeed = 0
			p.y = flr(p.y/8)*8
	end
	
	-- detect a trap
	if  c.left(2,p.x,p.y,2) or 
     c.right(2,p.x,p.y,2) or 
     c.up(2,p.x,p.y,2) or 
     c.down(2,p.x,p.y,2)
	then
		sfx(1)
		p.dead=true
	end								
 
 ------------------------------
 -- movement
	-- 	go left
	if btn(0) then
		p.xspeed -= p.accel
		p.xspeed = max(p.xspeed,-p.maxspeed)
		p.direction = true
		-- animation
		if p.on_ground then
   animate(p,33,34,5)
	 end
 end
	-- 	go right
	if btn(1) then
		p.xspeed += p.accel
		p.xspeed = min(p.xspeed,p.maxspeed)
		p.direction = false
		-- animation
		if p.on_ground then
   animate(p,33,34,5)
		end   
	end
	-- jump
	if btnp(5) then
		p.frame=35
		if p.yspeed == 0 and p.on_ground then
			sfx(0)
			p.yspeed = -p.jumpspeed
		end
		p.on_ground=false
	end

	------------------------------
	-- friction, when no button is pressed
	if not btn(0) and not btn(1) then
		if p.on_ground then p.frame=33 end 
		if p.xspeed < 0 then p.xspeed += p.friction end
		if p.xspeed > 0 then p.xspeed -= p.friction end
	end
 
	camera(p.x-64,p.y-64)
end

function _draw()
	cls()
	map(0,0,0,0)
	spr(p.frame,p.x,p.y,1,1,p.direction)
	if p.dead then
		rectfill(p.x-64,p.y-64,p.x+64,p.y+64,0)
		print("you are dead",p.x-16,p.y-8,8)
		print("press ‚ùé to restart",p.x-32,p.y,6)
	end
end





__gfx__
00000000665615560000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000111111112555055200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00700700155666560000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00077000111111110522222500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00077000665515660000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00700700111111115225055200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000156666550000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000111111110552225500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000050005000055555555555500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000057505750057766dd66677750000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000565056500055555555555500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000565056500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000565056500055555555555500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000005d505d50057766dd66677750000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000005d505d500055555555555500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000024444200244442002444420000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000024444442244444422444c44c000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000004944c44c4944444449442442000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000009a9424429a94c44c9a944765000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000494444444944244249444222000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000444427654444222244422222000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000244222222442276522200002000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000222222222222222200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
02448420000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
24488442000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
4948c84c000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
9a948848000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
89488448000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
48482765000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
24828652000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
82822882000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__gff__
0001000000000000000000000000000000020202000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__map__
010101010101020202020101010101013f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
010202020202020202020202020202013f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
01070000000000020200000000000601070707070707073f3f3f3f3f3f3f3f3f3f3f07073f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
01130000000000020200000000001201000000000000000707073f3f3f3f3f0707070404070707073f0707073f3f3f3f3f3f3f07043f3f3f073f00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0100000011000002020000110000000100000000000000003f3f070707070704040404040404040407043f04073f3f073f3f3f3f3f3f3f3f3f3f00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0107000001010101010101010000070100000000000000003f3f3f3f3f3f3f3f3f3f3f3f3f3f3f0404043f3f043f3f3f070707073f3f3f043f0400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0100000000000202020200000000000100000000000000003f3f3f3f073f3f3f3f3f063f3f3f3f3f043f3f3f043f3f3f3f3f3f3f3f3f3f3f3f3f00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0102000000000000000000000000020100000500000000003f3f3f3f3f0707073f3f3f3f3f3f3f3f04070707063f073f3f3f3f3f3f3f043f043f00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0101010011000000000000110001010100000000000000003f3f3f3f3f3f3f3f3f3f07073f3f3f3f053f3f3f3f073f3f3f3f3f3f3f3f3f3f3f0400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
010000010100000000000001010000010000000000000000073f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f043f3f3f00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0100000000000202020200000000000100000007070700003f3f3f3f3f3f053f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f073f3f3f3f3f3f00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0102000000000201010200000000020100000600000000003f3f3f3f3f3f3f3f3f3f3f3f3f3f0707073f073f3f3f3f3f3f3f3f3f3f073f073f3f00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0101010100000202020200000101010100000000000000003f0707073f0707073f3f3f0707073f3f3f3f3f3f3f0707073f3f3f3f3f3f3f3f3f3f00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0102000000000707000000000000020100000004000000003f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f04043f3f3f3f3f3f3f3f3f3f00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0100000000000000070000000505000100000004000005003f0505053f3f0505053f3f3f3f3f3f05053f3f3f050505053f3f3f3f3f3f3f3f3f3f00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0111111111111111111111111111110100000000000000003f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0101010101010101010101010101010100000000000000003f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000003f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f3f00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__sfx__
00020000095700d5701057010570105701b50024700237001d7000600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000d0000215501d5501a5501655013550105500c55008550075500355001550015500155001550140000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
011200001a7501d7501d7500000000000187501875000400000001d7501d750187501f750217500000000000000001d7501d750187501d75000000000000000000000217502375000000237501d7501875000000
000d00001b00011000090000200013500105000c50008500075000350001500015000150001500140000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000c0000e00010000110000000000000000000d0000c0000e00010000110000d00009000000000d0000c0000e00010000110000200003000040000d0000c0000e00010000110000000000000000000d000
__music__
03 02424344

